{"ast":null,"code":"import CryptoJS from 'crypto-js';\nexport function encryptMessage(sharedKeyBites, message) {\n  const iv = CryptoJS.lib.WordArray.random(16).toString(CryptoJS.enc.Base64);\n  const ivWordArray = CryptoJS.enc.Base64.parse(iv);\n  const sharedKey = CryptoJS.lib.WordArray.create(sharedKeyBites);\n\n  // Шифрование\n  const encryptedMessage = CryptoJS.AES.encrypt(JSON.stringify(message), sharedKey, {\n    iv: ivWordArray,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n  }).toString();\n  return {\n    iv: iv,\n    encryptedMessage: encryptedMessage\n  };\n}\n\n// Функция для расшифровки сообщения\nexport function decryptMessage(ivBase64, encryptedMessageBase64, sharedKeyBites) {\n  const iv = CryptoJS.enc.Base64.parse(ivBase64);\n  const encryptedMessage = CryptoJS.enc.Base64.parse(encryptedMessageBase64);\n  const sharedKey = CryptoJS.lib.WordArray.create(sharedKeyBites);\n  const decrypted = CryptoJS.AES.decrypt({\n    ciphertext: encryptedMessage\n  }, sharedKey,\n  // Преобразуем sharedKey\n  {\n    iv: iv,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n  });\n  const plaintext = decrypted.toString(CryptoJS.enc.Utf8);\n  return JSON.parse(plaintext);\n}","map":{"version":3,"names":["CryptoJS","encryptMessage","sharedKeyBites","message","iv","lib","WordArray","random","toString","enc","Base64","ivWordArray","parse","sharedKey","create","encryptedMessage","AES","encrypt","JSON","stringify","mode","CBC","padding","pad","Pkcs7","decryptMessage","ivBase64","encryptedMessageBase64","decrypted","decrypt","ciphertext","plaintext","Utf8"],"sources":["D:/учеба/3 курс/1 семестр/ИнфоБез/pracitce_3/practice_3_ui/src/cryptoTools.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\r\n\r\n\r\nexport function encryptMessage(sharedKeyBites, message) {\r\n    const iv = CryptoJS.lib.WordArray.random(16).toString(CryptoJS.enc.Base64);\r\n    const ivWordArray = CryptoJS.enc.Base64.parse(iv);\r\n\r\n    const sharedKey = CryptoJS.lib.WordArray.create(sharedKeyBites);\r\n\r\n    // Шифрование\r\n    const encryptedMessage = CryptoJS.AES.encrypt(\r\n        JSON.stringify(message), \r\n        sharedKey,  \r\n        {\r\n            iv: ivWordArray,\r\n            mode: CryptoJS.mode.CBC,\r\n            padding: CryptoJS.pad.Pkcs7,\r\n        }\r\n    ).toString();\r\n\r\n    return { iv: iv, encryptedMessage: encryptedMessage };\r\n}\r\n    \r\n\r\n// Функция для расшифровки сообщения\r\nexport function decryptMessage(ivBase64, encryptedMessageBase64, sharedKeyBites) {\r\n    const iv = CryptoJS.enc.Base64.parse(ivBase64);\r\n    const encryptedMessage = CryptoJS.enc.Base64.parse(encryptedMessageBase64);\r\n    const sharedKey = CryptoJS.lib.WordArray.create(sharedKeyBites);\r\n\r\n  \r\n    const decrypted = CryptoJS.AES.decrypt(\r\n      { ciphertext: encryptedMessage },\r\n      sharedKey, // Преобразуем sharedKey\r\n      {\r\n        iv: iv,\r\n        mode: CryptoJS.mode.CBC,\r\n        padding: CryptoJS.pad.Pkcs7,\r\n      }\r\n    );\r\n  \r\n    const plaintext = decrypted.toString(CryptoJS.enc.Utf8);\r\n    return JSON.parse(plaintext); \r\n  }\r\n\r\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAGhC,OAAO,SAASC,cAAcA,CAACC,cAAc,EAAEC,OAAO,EAAE;EACpD,MAAMC,EAAE,GAAGJ,QAAQ,CAACK,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC,CAACC,QAAQ,CAACR,QAAQ,CAACS,GAAG,CAACC,MAAM,CAAC;EAC1E,MAAMC,WAAW,GAAGX,QAAQ,CAACS,GAAG,CAACC,MAAM,CAACE,KAAK,CAACR,EAAE,CAAC;EAEjD,MAAMS,SAAS,GAAGb,QAAQ,CAACK,GAAG,CAACC,SAAS,CAACQ,MAAM,CAACZ,cAAc,CAAC;;EAE/D;EACA,MAAMa,gBAAgB,GAAGf,QAAQ,CAACgB,GAAG,CAACC,OAAO,CACzCC,IAAI,CAACC,SAAS,CAAChB,OAAO,CAAC,EACvBU,SAAS,EACT;IACIT,EAAE,EAAEO,WAAW;IACfS,IAAI,EAAEpB,QAAQ,CAACoB,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAEtB,QAAQ,CAACuB,GAAG,CAACC;EAC1B,CACJ,CAAC,CAAChB,QAAQ,CAAC,CAAC;EAEZ,OAAO;IAAEJ,EAAE,EAAEA,EAAE;IAAEW,gBAAgB,EAAEA;EAAiB,CAAC;AACzD;;AAGA;AACA,OAAO,SAASU,cAAcA,CAACC,QAAQ,EAAEC,sBAAsB,EAAEzB,cAAc,EAAE;EAC7E,MAAME,EAAE,GAAGJ,QAAQ,CAACS,GAAG,CAACC,MAAM,CAACE,KAAK,CAACc,QAAQ,CAAC;EAC9C,MAAMX,gBAAgB,GAAGf,QAAQ,CAACS,GAAG,CAACC,MAAM,CAACE,KAAK,CAACe,sBAAsB,CAAC;EAC1E,MAAMd,SAAS,GAAGb,QAAQ,CAACK,GAAG,CAACC,SAAS,CAACQ,MAAM,CAACZ,cAAc,CAAC;EAG/D,MAAM0B,SAAS,GAAG5B,QAAQ,CAACgB,GAAG,CAACa,OAAO,CACpC;IAAEC,UAAU,EAAEf;EAAiB,CAAC,EAChCF,SAAS;EAAE;EACX;IACET,EAAE,EAAEA,EAAE;IACNgB,IAAI,EAAEpB,QAAQ,CAACoB,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAEtB,QAAQ,CAACuB,GAAG,CAACC;EACxB,CACF,CAAC;EAED,MAAMO,SAAS,GAAGH,SAAS,CAACpB,QAAQ,CAACR,QAAQ,CAACS,GAAG,CAACuB,IAAI,CAAC;EACvD,OAAOd,IAAI,CAACN,KAAK,CAACmB,SAAS,CAAC;AAC9B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}