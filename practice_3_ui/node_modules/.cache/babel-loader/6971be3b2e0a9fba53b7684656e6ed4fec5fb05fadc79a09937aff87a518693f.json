{"ast":null,"code":"/* global BigInt */\n\nimport bigInt from 'big-integer';\nimport CryptoJS from 'crypto-js';\n\n// Генерация числа b\nexport function generateRandomNumber(minNum = 10, highNum = bigInt(10).pow(50)) {\n  const randomNumber = bigInt.randBetween(minNum, highNum);\n  console.log(\"Сгенерированное число:\", randomNumber.toString());\n  return randomNumber;\n}\n\n// Расчет числа B\nexport function calculateNumberB(g, b, p) {\n  const gBig = BigInt(g); // Преобразуем g в big-integer\n  const bBig = BigInt(b); // Преобразуем b в big-integer\n  const pBig = BigInt(p); // Преобразуем p в big-integer\n\n  const result = gBig.mod(pBig).pow(bBig.mod(pBig)).mod(pBig);\n  return result;\n}\n\n// Расчет общего числа\nexport function calculateNumberS(A, b, p) {\n  const ABig = BigInt(A);\n  const bBig = BigInt(b);\n  const pBig = BigInt(p);\n  const result = mod;\n}\nexport async function deriveKey(sharedKey) {\n  // Преобразуем sharedKey (число) в ArrayBuffer\n  const sharedKeyBuffer = new Uint8Array(BigInt(sharedKey).toString(16).match(/.{1,2}/g).map(byte => parseInt(byte, 16)));\n\n  // Константы HKDF\n  const salt = new Uint8Array(); // Используем null для соли\n  const info = new TextEncoder().encode('diffie-hellman encryption'); // Информация для HKDF\n\n  // Импортируем sharedKey как ключ\n  const baseKey = await crypto.subtle.importKey('raw', sharedKeyBuffer, {\n    name: 'HKDF'\n  }, false, ['deriveBits', 'deriveKey']);\n\n  // Генерируем производный ключ\n  const derivedKey = await crypto.subtle.deriveKey({\n    name: 'HKDF',\n    hash: 'SHA-256',\n    salt: salt,\n    info: info\n  }, baseKey, {\n    name: 'AES-CBC',\n    length: 256\n  },\n  // Тип производного ключа\n  true, ['encrypt', 'decrypt']);\n\n  // Экспортируем ключ в формате ArrayBuffer\n  const rawKey = await crypto.subtle.exportKey('raw', derivedKey);\n\n  // Возвращаем ключ в виде массива байтов\n  return uint8ArrayToWordArray(new Uint8Array(rawKey));\n}\nfunction uint8ArrayToWordArray(u8Array) {\n  const words = [];\n  for (let i = 0; i < u8Array.length; i += 4) {\n    words.push(u8Array[i] << 24 | u8Array[i + 1] << 16 | u8Array[i + 2] << 8 | u8Array[i + 3]);\n  }\n  return CryptoJS.lib.WordArray.create(words, u8Array.length);\n}\nfunction modPow(base, exponent, modulus) {\n  base = BigInt(base);\n  exponent = BigInt(exponent);\n  modulus = BigInt(modulus);\n  let result = 1n;\n  base = base % modulus;\n  while (exponent > 0n) {\n    if (exponent % 2n === 1n) {\n      result = result * base % modulus;\n    }\n    exponent = exponent >> 1n; // делим на 2\n    base = base * base % modulus;\n  }\n  return result;\n}","map":{"version":3,"names":["bigInt","CryptoJS","generateRandomNumber","minNum","highNum","pow","randomNumber","randBetween","console","log","toString","calculateNumberB","g","b","p","gBig","BigInt","bBig","pBig","result","mod","calculateNumberS","A","ABig","deriveKey","sharedKey","sharedKeyBuffer","Uint8Array","match","map","byte","parseInt","salt","info","TextEncoder","encode","baseKey","crypto","subtle","importKey","name","derivedKey","hash","length","rawKey","exportKey","uint8ArrayToWordArray","u8Array","words","i","push","lib","WordArray","create","modPow","base","exponent","modulus"],"sources":["D:/учеба/3 курс/1 семестр/ИнфоБез/pracitce_3/practice_3_ui/src/numberTools.js"],"sourcesContent":["/* global BigInt */\r\n\r\nimport bigInt from 'big-integer';\r\nimport CryptoJS from 'crypto-js';\r\n\r\n\r\n// Генерация числа b\r\nexport function generateRandomNumber(minNum = 10, highNum = bigInt(10).pow(50)) {\r\n    const randomNumber = bigInt.randBetween(minNum, highNum);\r\n\r\n    console.log(\"Сгенерированное число:\", randomNumber.toString());\r\n\r\n    return randomNumber;\r\n}\r\n\r\n// Расчет числа B\r\nexport function calculateNumberB(g, b, p) {\r\n    const gBig = BigInt(g); // Преобразуем g в big-integer\r\n    const bBig = BigInt(b); // Преобразуем b в big-integer\r\n    const pBig = BigInt(p); // Преобразуем p в big-integer\r\n\r\n    const result = gBig.mod(pBig).pow(bBig.mod(pBig)).mod(pBig);\r\n\r\n    return result;\r\n}\r\n\r\n// Расчет общего числа\r\nexport function calculateNumberS(A, b, p) {\r\n    const ABig= BigInt(A)\r\n    const bBig= BigInt(b)\r\n    const pBig= BigInt(p)\r\n\r\n    const result = mod\r\n}\r\n\r\nexport async function deriveKey(sharedKey) {\r\n    // Преобразуем sharedKey (число) в ArrayBuffer\r\n    const sharedKeyBuffer = new Uint8Array(\r\n      BigInt(sharedKey).toString(16).match(/.{1,2}/g).map((byte) => parseInt(byte, 16))\r\n    );\r\n  \r\n    // Константы HKDF\r\n    const salt = new Uint8Array(); // Используем null для соли\r\n    const info = new TextEncoder().encode('diffie-hellman encryption'); // Информация для HKDF\r\n  \r\n    // Импортируем sharedKey как ключ\r\n    const baseKey = await crypto.subtle.importKey(\r\n      'raw',\r\n      sharedKeyBuffer,\r\n      { name: 'HKDF' },\r\n      false,\r\n      ['deriveBits', 'deriveKey']\r\n    );\r\n  \r\n    // Генерируем производный ключ\r\n    const derivedKey = await crypto.subtle.deriveKey(\r\n      {\r\n        name: 'HKDF',\r\n        hash: 'SHA-256',\r\n        salt: salt,\r\n        info: info,\r\n      },\r\n      baseKey,\r\n      { name: 'AES-CBC', length: 256 }, // Тип производного ключа\r\n      true,\r\n      ['encrypt', 'decrypt']\r\n    );\r\n  \r\n    // Экспортируем ключ в формате ArrayBuffer\r\n    const rawKey = await crypto.subtle.exportKey('raw', derivedKey);\r\n  \r\n    // Возвращаем ключ в виде массива байтов\r\n    return uint8ArrayToWordArray(new Uint8Array(rawKey));\r\n  }\r\n  \r\n\r\n  function uint8ArrayToWordArray(u8Array) {\r\n    const words = [];\r\n    for (let i = 0; i < u8Array.length; i += 4) {\r\n        words.push(\r\n            (u8Array[i] << 24) |\r\n            (u8Array[i + 1] << 16) |\r\n            (u8Array[i + 2] << 8) |\r\n            u8Array[i + 3]\r\n        );\r\n    }\r\n    return CryptoJS.lib.WordArray.create(words, u8Array.length);\r\n}\r\n\r\nfunction modPow(base, exponent, modulus) {\r\n    base = BigInt(base);\r\n    exponent = BigInt(exponent);\r\n    modulus = BigInt(modulus);\r\n\r\n    let result = 1n;\r\n    base = base % modulus;\r\n\r\n    while (exponent > 0n) {\r\n        if (exponent % 2n === 1n) {\r\n            result = (result * base) % modulus;\r\n        }\r\n        exponent = exponent >> 1n; // делим на 2\r\n        base = (base * base) % modulus;\r\n    }\r\n\r\n    return result;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}