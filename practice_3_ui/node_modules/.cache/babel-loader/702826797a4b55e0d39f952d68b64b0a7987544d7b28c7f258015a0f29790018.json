{"ast":null,"code":"import CryptoJS from 'crypto-js';\nexport function encryptMessage(sharedKey, message) {\n  // Генерация IV\n  const iv = CryptoJS.lib.WordArray.random(16).toString(CryptoJS.enc.Base64);\n  const ivWordArray = CryptoJS.enc.Base64.parse(iv);\n  sharedKey = CryptoJS.enc.Hex.stringify(sharedKey);\n  sharedKey = sharedKey.slice(0, 32).padEnd(32, \"0\");\n\n  // Проверка sharedKey\n  if (!sharedKey || sharedKey.length !== 16) {\n    console.error(\"Ошибка: sharedKey должен быть строкой длиной 16 символов.\");\n    throw new Error(\"Некорректный sharedKey\");\n  }\n\n  // Шифрование\n  const encryptedMessage = CryptoJS.AES.encrypt(JSON.stringify(message),\n  // Преобразование в JSON\n  CryptoJS.enc.Utf8.parse(sharedKey), {\n    iv: ivWordArray,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n  }).toString();\n  console.log(\"Зашифрованное сообщение:\", encryptedMessage);\n  console.log(\"IV:\", iv);\n  return {\n    iv: iv,\n    encryptedMessage: encryptedMessage\n  };\n}\n\n// Функция для расшифровки сообщения\nexport function decryptMessage(ivBase64, encryptedMessageBase64, sharedKey) {\n  const iv = CryptoJS.enc.Base64.parse(ivBase64);\n  const encryptedMessage = CryptoJS.enc.Base64.parse(encryptedMessageBase64);\n  const decrypted = CryptoJS.AES.decrypt({\n    ciphertext: encryptedMessage\n  }, sharedKey,\n  // Преобразуем sharedKey\n  {\n    iv: iv,\n    mode: CryptoJS.mode.CBC,\n    padding: CryptoJS.pad.Pkcs7\n  });\n  const plaintext = decrypted.toString(CryptoJS.enc.Utf8);\n  return JSON.parse(plaintext); // Предполагаем, что сообщение в формате JSON\n}","map":{"version":3,"names":["CryptoJS","encryptMessage","sharedKey","message","iv","lib","WordArray","random","toString","enc","Base64","ivWordArray","parse","Hex","stringify","slice","padEnd","length","console","error","Error","encryptedMessage","AES","encrypt","JSON","Utf8","mode","CBC","padding","pad","Pkcs7","log","decryptMessage","ivBase64","encryptedMessageBase64","decrypted","decrypt","ciphertext","plaintext"],"sources":["D:/учеба/3 курс/1 семестр/ИнфоБез/pracitce_3/practice_3_ui/src/cryptoTools.js"],"sourcesContent":["import CryptoJS from 'crypto-js';\r\n\r\nexport function encryptMessage(sharedKey, message) {\r\n     // Генерация IV\r\n     const iv = CryptoJS.lib.WordArray.random(16).toString(CryptoJS.enc.Base64);\r\n     const ivWordArray = CryptoJS.enc.Base64.parse(iv);\r\n \r\n     sharedKey = CryptoJS.enc.Hex.stringify(sharedKey);\r\n     sharedKey = sharedKey.slice(0, 32).padEnd(32, \"0\");\r\n\r\n     // Проверка sharedKey\r\n     if (!sharedKey || sharedKey.length !== 16) {\r\n         console.error(\"Ошибка: sharedKey должен быть строкой длиной 16 символов.\");\r\n         throw new Error(\"Некорректный sharedKey\");\r\n     }\r\n \r\n     // Шифрование\r\n     const encryptedMessage = CryptoJS.AES.encrypt(\r\n         JSON.stringify(message), // Преобразование в JSON\r\n         CryptoJS.enc.Utf8.parse(sharedKey),\r\n         {\r\n             iv: ivWordArray,\r\n             mode: CryptoJS.mode.CBC,\r\n             padding: CryptoJS.pad.Pkcs7,\r\n         }\r\n     ).toString();\r\n \r\n     console.log(\"Зашифрованное сообщение:\", encryptedMessage);\r\n     console.log(\"IV:\", iv);\r\n \r\n     return { iv: iv, encryptedMessage: encryptedMessage };\r\n }\r\n\r\n\r\n// Функция для расшифровки сообщения\r\nexport function decryptMessage(ivBase64, encryptedMessageBase64, sharedKey) {\r\n    const iv = CryptoJS.enc.Base64.parse(ivBase64);\r\n    const encryptedMessage = CryptoJS.enc.Base64.parse(encryptedMessageBase64);\r\n  \r\n    const decrypted = CryptoJS.AES.decrypt(\r\n      { ciphertext: encryptedMessage },\r\n      sharedKey, // Преобразуем sharedKey\r\n      {\r\n        iv: iv,\r\n        mode: CryptoJS.mode.CBC,\r\n        padding: CryptoJS.pad.Pkcs7,\r\n      }\r\n    );\r\n  \r\n    const plaintext = decrypted.toString(CryptoJS.enc.Utf8);\r\n    return JSON.parse(plaintext); // Предполагаем, что сообщение в формате JSON\r\n  }\r\n\r\n"],"mappings":"AAAA,OAAOA,QAAQ,MAAM,WAAW;AAEhC,OAAO,SAASC,cAAcA,CAACC,SAAS,EAAEC,OAAO,EAAE;EAC9C;EACA,MAAMC,EAAE,GAAGJ,QAAQ,CAACK,GAAG,CAACC,SAAS,CAACC,MAAM,CAAC,EAAE,CAAC,CAACC,QAAQ,CAACR,QAAQ,CAACS,GAAG,CAACC,MAAM,CAAC;EAC1E,MAAMC,WAAW,GAAGX,QAAQ,CAACS,GAAG,CAACC,MAAM,CAACE,KAAK,CAACR,EAAE,CAAC;EAEjDF,SAAS,GAAGF,QAAQ,CAACS,GAAG,CAACI,GAAG,CAACC,SAAS,CAACZ,SAAS,CAAC;EACjDA,SAAS,GAAGA,SAAS,CAACa,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAACC,MAAM,CAAC,EAAE,EAAE,GAAG,CAAC;;EAElD;EACA,IAAI,CAACd,SAAS,IAAIA,SAAS,CAACe,MAAM,KAAK,EAAE,EAAE;IACvCC,OAAO,CAACC,KAAK,CAAC,2DAA2D,CAAC;IAC1E,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;EAC7C;;EAEA;EACA,MAAMC,gBAAgB,GAAGrB,QAAQ,CAACsB,GAAG,CAACC,OAAO,CACzCC,IAAI,CAACV,SAAS,CAACX,OAAO,CAAC;EAAE;EACzBH,QAAQ,CAACS,GAAG,CAACgB,IAAI,CAACb,KAAK,CAACV,SAAS,CAAC,EAClC;IACIE,EAAE,EAAEO,WAAW;IACfe,IAAI,EAAE1B,QAAQ,CAAC0B,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAE5B,QAAQ,CAAC6B,GAAG,CAACC;EAC1B,CACJ,CAAC,CAACtB,QAAQ,CAAC,CAAC;EAEZU,OAAO,CAACa,GAAG,CAAC,0BAA0B,EAAEV,gBAAgB,CAAC;EACzDH,OAAO,CAACa,GAAG,CAAC,KAAK,EAAE3B,EAAE,CAAC;EAEtB,OAAO;IAAEA,EAAE,EAAEA,EAAE;IAAEiB,gBAAgB,EAAEA;EAAiB,CAAC;AACzD;;AAGD;AACA,OAAO,SAASW,cAAcA,CAACC,QAAQ,EAAEC,sBAAsB,EAAEhC,SAAS,EAAE;EACxE,MAAME,EAAE,GAAGJ,QAAQ,CAACS,GAAG,CAACC,MAAM,CAACE,KAAK,CAACqB,QAAQ,CAAC;EAC9C,MAAMZ,gBAAgB,GAAGrB,QAAQ,CAACS,GAAG,CAACC,MAAM,CAACE,KAAK,CAACsB,sBAAsB,CAAC;EAE1E,MAAMC,SAAS,GAAGnC,QAAQ,CAACsB,GAAG,CAACc,OAAO,CACpC;IAAEC,UAAU,EAAEhB;EAAiB,CAAC,EAChCnB,SAAS;EAAE;EACX;IACEE,EAAE,EAAEA,EAAE;IACNsB,IAAI,EAAE1B,QAAQ,CAAC0B,IAAI,CAACC,GAAG;IACvBC,OAAO,EAAE5B,QAAQ,CAAC6B,GAAG,CAACC;EACxB,CACF,CAAC;EAED,MAAMQ,SAAS,GAAGH,SAAS,CAAC3B,QAAQ,CAACR,QAAQ,CAACS,GAAG,CAACgB,IAAI,CAAC;EACvD,OAAOD,IAAI,CAACZ,KAAK,CAAC0B,SAAS,CAAC,CAAC,CAAC;AAChC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}