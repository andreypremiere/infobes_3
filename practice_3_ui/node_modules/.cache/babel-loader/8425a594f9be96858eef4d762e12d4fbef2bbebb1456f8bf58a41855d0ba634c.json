{"ast":null,"code":"import { decodeToken, getTokenFromCookie } from \"../JWTProvider\";\nimport { encryptMessage, decryptMessage } from \"../cryptoTools\";\nexport async function requestUpdateNote(data, sharedKey) {\n  const encryptedMessage = encryptMessage(sharedKey, data);\n  const result = await fetch('http://localhost:5000/update_note', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      'iv': encryptedMessage.iv,\n      'encryptedMessage': encryptedMessage.encryptedMessage\n    })\n  });\n  if (result.status === 200) {\n    return true;\n  }\n  return false;\n}\nexport async function requestGetNotes(sharedKey) {\n  let data_token = decodeToken(getTokenFromCookie());\n  console.log('data_token', data_token);\n  let nickName = data_token.nickName;\n  let role = data_token.role;\n  const data = {\n    'nickName': nickName,\n    'role': role\n  };\n  const encryptedMessage = encryptMessage(sharedKey, data);\n  const result = await fetch('http://localhost:5000/get_user_notes', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      'iv': encryptedMessage.iv,\n      'encryptedMessage': encryptedMessage.encryptedMessage\n    })\n  });\n  const responseData = await result.json();\n  const decryptedData = decryptMessage(responseData.iv, responseData.encryptedMessage, sharedKey);\n  console.log(de);\n  return decryptedData.notes;\n}\nexport async function requestAddNote(sendingData, sharedKey) {\n  const encryptedMessage = encryptMessage(sharedKey, sendingData);\n  const result = await fetch('http://localhost:5000/add_note', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      'iv': encryptedMessage.iv,\n      'encryptedMessage': encryptedMessage.encryptedMessage\n    })\n  });\n  const responseData = await result.json();\n  const decryptedData = decryptMessage(responseData.iv, responseData.encryptedMessage, sharedKey);\n  return decryptedData;\n}","map":{"version":3,"names":["decodeToken","getTokenFromCookie","encryptMessage","decryptMessage","requestUpdateNote","data","sharedKey","encryptedMessage","result","fetch","method","headers","body","JSON","stringify","iv","status","requestGetNotes","data_token","console","log","nickName","role","responseData","json","decryptedData","de","notes","requestAddNote","sendingData"],"sources":["D:/учеба/3 курс/1 семестр/ИнфоБез/pracitce_3/practice_3_ui/src/requests/requestNotes.js"],"sourcesContent":["import { decodeToken, getTokenFromCookie } from \"../JWTProvider\"\r\nimport { encryptMessage, decryptMessage } from \"../cryptoTools\"\r\n\r\nexport async function requestUpdateNote(data, sharedKey) {\r\n\r\n    const encryptedMessage = encryptMessage(sharedKey, data)\r\n\r\n    const result = await fetch('http://localhost:5000/update_note', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            'iv': encryptedMessage.iv, \r\n            'encryptedMessage': encryptedMessage.encryptedMessage\r\n        }),\r\n    })\r\n\r\n    if (result.status === 200) {\r\n        return true\r\n    }\r\n    \r\n    return false\r\n}\r\n\r\nexport async function requestGetNotes(sharedKey) {\r\n    let data_token = decodeToken(getTokenFromCookie())\r\n    console.log('data_token', data_token)\r\n    let nickName = data_token.nickName\r\n    let role = data_token.role\r\n\r\n    const data = {'nickName': nickName, 'role': role}\r\n\r\n    const encryptedMessage = encryptMessage(sharedKey, data)\r\n\r\n    const result = await fetch('http://localhost:5000/get_user_notes', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            'iv': encryptedMessage.iv, \r\n            'encryptedMessage': encryptedMessage.encryptedMessage\r\n        }),\r\n    })\r\n\r\n    const responseData = await result.json();\r\n\r\n    const decryptedData = decryptMessage(responseData.iv, responseData.encryptedMessage, sharedKey)\r\n\r\n    console.log(de)\r\n    return decryptedData.notes\r\n}\r\n\r\nexport async function requestAddNote(sendingData, sharedKey) {\r\n\r\n    const encryptedMessage = encryptMessage(sharedKey, sendingData)\r\n\r\n    const result = await fetch('http://localhost:5000/add_note', {\r\n        method: 'POST',\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n            'iv': encryptedMessage.iv, \r\n            'encryptedMessage': encryptedMessage.encryptedMessage\r\n        }),\r\n    })\r\n\r\n    const responseData = await result.json();\r\n\r\n    const decryptedData = decryptMessage(responseData.iv, responseData.encryptedMessage, sharedKey)\r\n\r\n    return decryptedData\r\n}\r\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,kBAAkB,QAAQ,gBAAgB;AAChE,SAASC,cAAc,EAAEC,cAAc,QAAQ,gBAAgB;AAE/D,OAAO,eAAeC,iBAAiBA,CAACC,IAAI,EAAEC,SAAS,EAAE;EAErD,MAAMC,gBAAgB,GAAGL,cAAc,CAACI,SAAS,EAAED,IAAI,CAAC;EAExD,MAAMG,MAAM,GAAG,MAAMC,KAAK,CAAC,mCAAmC,EAAE;IAC5DC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MACL,cAAc,EAAE;IACpB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MACjB,IAAI,EAAEP,gBAAgB,CAACQ,EAAE;MACzB,kBAAkB,EAAER,gBAAgB,CAACA;IACzC,CAAC;EACL,CAAC,CAAC;EAEF,IAAIC,MAAM,CAACQ,MAAM,KAAK,GAAG,EAAE;IACvB,OAAO,IAAI;EACf;EAEA,OAAO,KAAK;AAChB;AAEA,OAAO,eAAeC,eAAeA,CAACX,SAAS,EAAE;EAC7C,IAAIY,UAAU,GAAGlB,WAAW,CAACC,kBAAkB,CAAC,CAAC,CAAC;EAClDkB,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEF,UAAU,CAAC;EACrC,IAAIG,QAAQ,GAAGH,UAAU,CAACG,QAAQ;EAClC,IAAIC,IAAI,GAAGJ,UAAU,CAACI,IAAI;EAE1B,MAAMjB,IAAI,GAAG;IAAC,UAAU,EAAEgB,QAAQ;IAAE,MAAM,EAAEC;EAAI,CAAC;EAEjD,MAAMf,gBAAgB,GAAGL,cAAc,CAACI,SAAS,EAAED,IAAI,CAAC;EAExD,MAAMG,MAAM,GAAG,MAAMC,KAAK,CAAC,sCAAsC,EAAE;IAC/DC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MACL,cAAc,EAAE;IACpB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MACjB,IAAI,EAAEP,gBAAgB,CAACQ,EAAE;MACzB,kBAAkB,EAAER,gBAAgB,CAACA;IACzC,CAAC;EACL,CAAC,CAAC;EAEF,MAAMgB,YAAY,GAAG,MAAMf,MAAM,CAACgB,IAAI,CAAC,CAAC;EAExC,MAAMC,aAAa,GAAGtB,cAAc,CAACoB,YAAY,CAACR,EAAE,EAAEQ,YAAY,CAAChB,gBAAgB,EAAED,SAAS,CAAC;EAE/Fa,OAAO,CAACC,GAAG,CAACM,EAAE,CAAC;EACf,OAAOD,aAAa,CAACE,KAAK;AAC9B;AAEA,OAAO,eAAeC,cAAcA,CAACC,WAAW,EAAEvB,SAAS,EAAE;EAEzD,MAAMC,gBAAgB,GAAGL,cAAc,CAACI,SAAS,EAAEuB,WAAW,CAAC;EAE/D,MAAMrB,MAAM,GAAG,MAAMC,KAAK,CAAC,gCAAgC,EAAE;IACzDC,MAAM,EAAE,MAAM;IACdC,OAAO,EAAE;MACL,cAAc,EAAE;IACpB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MACjB,IAAI,EAAEP,gBAAgB,CAACQ,EAAE;MACzB,kBAAkB,EAAER,gBAAgB,CAACA;IACzC,CAAC;EACL,CAAC,CAAC;EAEF,MAAMgB,YAAY,GAAG,MAAMf,MAAM,CAACgB,IAAI,CAAC,CAAC;EAExC,MAAMC,aAAa,GAAGtB,cAAc,CAACoB,YAAY,CAACR,EAAE,EAAEQ,YAAY,CAAChB,gBAAgB,EAAED,SAAS,CAAC;EAE/F,OAAOmB,aAAa;AACxB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}