{"ast":null,"code":"/* global BigInt */\n\nimport bigInt from 'big-integer';\nimport CryptoJS from 'crypto-js';\n\n// Генерация числа b\nexport function generateRandomNumber(minNum = 10, highNum = bigInt(10).pow(50)) {\n  const randomNumber = bigInt.randBetween(minNum, highNum);\n  console.log(\"Сгенерированное число:\", randomNumber.toString());\n  return randomNumber;\n}\n\n// Расчет числа B\nexport function calculateNumberB(g, b, p) {\n  const gBig = bigInt(g); // Преобразуем g в big-integer\n  const bBig = bigInt(b); // Преобразуем b в big-integer\n  const pBig = bigInt(p); // Преобразуем p в big-integer\n\n  const result = gBig.pow(bBig).mod(pBig);\n  return result;\n}\n\n// Расчет общего числа\nexport function calculateNumberS(A, b, p) {\n  const ABig = bigInt(A);\n  const bBig = bigInt(b);\n  const pBig = bigInt(p);\n  const result = A.pow(b).mod(p);\n}\nexport async function deriveKey(sharedKey) {\n  // Преобразуем sharedKey (число) в ArrayBuffer\n  const sharedKeyBuffer = new Uint8Array(BigInt(sharedKey).toString(16).match(/.{1,2}/g).map(byte => parseInt(byte, 16)));\n\n  // Константы HKDF\n  const salt = new Uint8Array(); // Используем null для соли\n  const info = new TextEncoder().encode('diffie-hellman encryption'); // Информация для HKDF\n\n  // Импортируем sharedKey как ключ\n  const baseKey = await crypto.subtle.importKey('raw', sharedKeyBuffer, {\n    name: 'HKDF'\n  }, false, ['deriveBits', 'deriveKey']);\n\n  // Генерируем производный ключ\n  const derivedKey = await crypto.subtle.deriveKey({\n    name: 'HKDF',\n    hash: 'SHA-256',\n    salt: salt,\n    info: info\n  }, baseKey, {\n    name: 'AES-CBC',\n    length: 256\n  },\n  // Тип производного ключа\n  true, ['encrypt', 'decrypt']);\n\n  // Экспортируем ключ в формате ArrayBuffer\n  const rawKey = await crypto.subtle.exportKey('raw', derivedKey);\n\n  // Возвращаем ключ в виде массива байтов\n  return uint8ArrayToWordArray(new Uint8Array(rawKey));\n}\nfunction uint8ArrayToWordArray(u8Array) {\n  const words = [];\n  for (let i = 0; i < u8Array.length; i += 4) {\n    words.push(u8Array[i] << 24 | u8Array[i + 1] << 16 | u8Array[i + 2] << 8 | u8Array[i + 3]);\n  }\n  return CryptoJS.lib.WordArray.create(words, u8Array.length);\n}","map":{"version":3,"names":["bigInt","CryptoJS","generateRandomNumber","minNum","highNum","pow","randomNumber","randBetween","console","log","toString","calculateNumberB","g","b","p","gBig","bBig","pBig","result","mod","calculateNumberS","A","ABig","deriveKey","sharedKey","sharedKeyBuffer","Uint8Array","BigInt","match","map","byte","parseInt","salt","info","TextEncoder","encode","baseKey","crypto","subtle","importKey","name","derivedKey","hash","length","rawKey","exportKey","uint8ArrayToWordArray","u8Array","words","i","push","lib","WordArray","create"],"sources":["D:/учеба/3 курс/1 семестр/ИнфоБез/pracitce_3/practice_3_ui/src/numberTools.js"],"sourcesContent":["/* global BigInt */\r\n\r\nimport bigInt from 'big-integer';\r\nimport CryptoJS from 'crypto-js';\r\n\r\n\r\n// Генерация числа b\r\nexport function generateRandomNumber(minNum = 10, highNum = bigInt(10).pow(50)) {\r\n    const randomNumber = bigInt.randBetween(minNum, highNum);\r\n\r\n    console.log(\"Сгенерированное число:\", randomNumber.toString());\r\n\r\n    return randomNumber;\r\n}\r\n\r\n// Расчет числа B\r\nexport function calculateNumberB(g, b, p) {\r\n    const gBig = bigInt(g); // Преобразуем g в big-integer\r\n    const bBig = bigInt(b); // Преобразуем b в big-integer\r\n    const pBig = bigInt(p); // Преобразуем p в big-integer\r\n\r\n    const result = gBig.pow(bBig).mod(pBig);\r\n\r\n    return result;\r\n}\r\n\r\n// Расчет общего числа\r\nexport function calculateNumberS(A, b, p) {\r\n    const ABig= bigInt(A)\r\n    const bBig= bigInt(b)\r\n    const pBig= bigInt(p)\r\n\r\n    const result = A.pow(b).mod(p);\r\n}\r\n\r\nexport async function deriveKey(sharedKey) {\r\n    // Преобразуем sharedKey (число) в ArrayBuffer\r\n    const sharedKeyBuffer = new Uint8Array(\r\n      BigInt(sharedKey).toString(16).match(/.{1,2}/g).map((byte) => parseInt(byte, 16))\r\n    );\r\n  \r\n    // Константы HKDF\r\n    const salt = new Uint8Array(); // Используем null для соли\r\n    const info = new TextEncoder().encode('diffie-hellman encryption'); // Информация для HKDF\r\n  \r\n    // Импортируем sharedKey как ключ\r\n    const baseKey = await crypto.subtle.importKey(\r\n      'raw',\r\n      sharedKeyBuffer,\r\n      { name: 'HKDF' },\r\n      false,\r\n      ['deriveBits', 'deriveKey']\r\n    );\r\n  \r\n    // Генерируем производный ключ\r\n    const derivedKey = await crypto.subtle.deriveKey(\r\n      {\r\n        name: 'HKDF',\r\n        hash: 'SHA-256',\r\n        salt: salt,\r\n        info: info,\r\n      },\r\n      baseKey,\r\n      { name: 'AES-CBC', length: 256 }, // Тип производного ключа\r\n      true,\r\n      ['encrypt', 'decrypt']\r\n    );\r\n  \r\n    // Экспортируем ключ в формате ArrayBuffer\r\n    const rawKey = await crypto.subtle.exportKey('raw', derivedKey);\r\n  \r\n    // Возвращаем ключ в виде массива байтов\r\n    return uint8ArrayToWordArray(new Uint8Array(rawKey));\r\n  }\r\n  \r\n\r\n  function uint8ArrayToWordArray(u8Array) {\r\n    const words = [];\r\n    for (let i = 0; i < u8Array.length; i += 4) {\r\n        words.push(\r\n            (u8Array[i] << 24) |\r\n            (u8Array[i + 1] << 16) |\r\n            (u8Array[i + 2] << 8) |\r\n            u8Array[i + 3]\r\n        );\r\n    }\r\n    return CryptoJS.lib.WordArray.create(words, u8Array.length);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}